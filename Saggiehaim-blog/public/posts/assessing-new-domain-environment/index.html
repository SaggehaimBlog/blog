<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8080&amp;path=livereload" data-no-instant defer></script>
  <title>Assessing New Domain Environment - Saggie Haim - Automate Everything</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="I had a free day yesterday, and I always love to spend my free time on the Xbox or PlayStation, depends on the mood. So, while Iâ€™m rushing and jumping all over Australia with my Lamborghini, I got a phone call, my first instinct was to mute it and continue with my race, but it was a good friend&amp;hellip; so I muted it anyway ðŸ˜¶. When I finished the race, I called him back (yes, Iâ€™m a good friendðŸ˜œ)."
/>
<meta
  name="keywords"
  content="Domain environment assessment, IT Domain evaluation, Network setup audit, Active Directory assessment, IT infrastructure review, Network security check, Domain setup audit tools, Active Directory health check, IT environment analysis"
/>
<meta name="robots" content="noodp" />
<meta property="og:url" content="//localhost:8080/posts/assessing-new-domain-environment/">
  <meta property="og:site_name" content="Saggie Haim - Automate Everything">
  <meta property="og:title" content="Assessing New Domain Environment">
  <meta property="og:description" content="n this blog post, I share insights on assessing a new domain environment, highlighting key steps and considerations. The article covers preliminary checks, tools to use, and best practices to ensure a smooth evaluation process. Whether youâ€™re setting up a new network or auditing an existing one, this guide provides practical advice to help you effectively manage and secure your domain environment.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2018-09-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2018-09-25T00:00:00+00:00">
    <meta property="article:tag" content="PowerShell">
    <meta property="article:tag" content="Active Directory">
    <meta property="article:tag" content="IT Security">
    <meta property="article:tag" content="Domain Assessment">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Assessing New Domain Environment">
  <meta name="twitter:description" content="n this blog post, I share insights on assessing a new domain environment, highlighting key steps and considerations. The article covers preliminary checks, tools to use, and best practices to ensure a smooth evaluation process. Whether youâ€™re setting up a new network or auditing an existing one, this guide provides practical advice to help you effectively manage and secure your domain environment.">


<link rel="canonical" href="//localhost:8080/posts/assessing-new-domain-environment/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.fe774fb74e49df8cc7f1a574367e700bb4eacc0d2a130948a3b2047afc133702.css">





  






  
  

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
    
<div class="fixed right-0 top-0 z-50 flex items-center justify-center bg-gray-200 p-2 text-sm uppercase text-black sm:bg-red-200 md:bg-yellow-200 lg:bg-green-200 xl:bg-blue-200 2xl:bg-pink-200">
  <span class="block sm:hidden">all</span>
  <span class="hidden sm:block md:hidden">sm</span>
  <span class="hidden md:block lg:hidden">md</span>
  <span class="hidden lg:block xl:hidden">lg</span>
  <span class="hidden xl:block 2xl:hidden">xl</span>
  <span class="hidden 2xl:block">2xl</span>
</div>

  <header class="flex flex-none justify-center z-10 bg-slate-50 dark:bg-gray-800 sticky top-0">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl my-4">
  <div class="flex-none ml-2  md:ml-0">
    <a href="/" class="">
      <img class="h-13 w-12" src="/white_logo.png" alt="logo">
    </a>
  </div>
  <div class="flex-none mx-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="home" class="">
          <a class="block px-3 py-3 hover:text-blue-600  dark:hover:text-blue-400 text-blue-600 dark:text-blue-200"
            href="/posts/" title="Home">Home</a>
        </li>
      
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-blue-600  dark:hover:text-blue-400"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="contact" class="">
          <a class="block px-3 py-3 hover:text-blue-600  dark:hover:text-blue-400"
            href="/contact/" title="Contact">Contact</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  <div class="flex-1"></div>

  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/posts/assessing-new-domain-environment/">
        <picture>
    <source type="image/webp" srcset="/posts/assessing-new-domain-environment/images/assest-a-new-domain_huacdc32759d95be1681d2bb80bf144610_28073_960x0_resize_q75_h2_box_3.webp 960w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <source type="image/jpeg" srcset="/posts/assessing-new-domain-environment/images/assest-a-new-domain_huacdc32759d95be1681d2bb80bf144610_28073_960x0_resize_q75_bgffffff_box_3.jpg 960w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <img class="w-full object-cover h-36 md:h-48 xl:h-60" src="/posts/assessing-new-domain-environment/images/assest-a-new-domain_huacdc32759d95be1681d2bb80bf144610_28073_640x0_resize_q75_bgffffff_box_3.jpg" width="977" height="381" alt="Assessing New Domain Environment" title="Assessing New Domain Environment" loading="lazy" />
  </picture>
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/posts/assessing-new-domain-environment/">Assessing New Domain Environment</a>
      </h1>

      
      <h2 class="my-4 text-large text-slate-600 dark:text-slate-300">
        n this blog post, I share insights on assessing a new domain environment, highlighting key steps and considerations. The article covers preliminary checks, tools to use, and best practices to ensure a smooth evaluation process. Whether youâ€™re setting up a new network or auditing an existing one, this guide provides practical advice to help you effectively manage and secure your domain environment.
      </h2>
      
      
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/active-directory/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          Active Directory
        </a>
      </li>
      
      <li>
        <a href="/categories/powershell/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          PowerShell
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/powershell/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">PowerShell</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/active-directory/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Active Directory</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/it-security/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">IT Security</span>
        </a>
      </li>
      
      <li>
        <a href="/tags/domain-assessment/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">Domain Assessment</span>
        </a>
      </li>
      
    
  </ul>


      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2018-09-25T00:00:00&#43;00:00">
      2018-09-25
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      5 minutes to read
    </span>
  </div>
</div>


      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#forest-information">Forest Information</a></li>
    <li><a href="#domain-information">Domain Information</a></li>
    <li><a href="#gpo-information">GPO Information</a></li>
    <li><a href="#dhcp-authorized-server-information">DHCP Authorized Server Information</a></li>
    <li><a href="#users-information">Users&rsquo; Information</a></li>
    <li><a href="#group-information">Group Information</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <p>I had a free day yesterday, and I always love to spend my free time on the Xbox or PlayStation, depends on the mood.
So, while Iâ€™m rushing and jumping all over Australia with my Lamborghini, I got a phone call, my first instinct was to mute it and continue with my race, but it was a good friend&hellip; so I muted it anyway ðŸ˜¶.
When I finished the race, I called him back (yes, Iâ€™m a good friendðŸ˜œ).
after a quick chit chat, he told me that he needs help to assess a new domain environment he needs to work on.</p>
<p><div class="not-prose">
<picture>
    <source type="image/webp" srcset="/posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_320x0_resize_q75_h2_box_3.webp 320w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_640x0_resize_q75_h2_box_3.webp 640w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_960x0_resize_q75_h2_box_3.webp 960w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_1280x0_resize_q75_h2_box_3.webp 1280w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_1600x0_resize_q75_h2_box_3.webp 1600w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <source type="image/jpeg" srcset="/posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_320x0_resize_q75_bgffffff_box_3.jpg 320w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_640x0_resize_q75_bgffffff_box_3.jpg 640w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_960x0_resize_q75_bgffffff_box_3.jpg 960w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_1280x0_resize_q75_bgffffff_box_3.jpg 1280w, /posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_1600x0_resize_q75_bgffffff_box_3.jpg 1600w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <img class="h-auto max-w-full rounded-lg" src="/posts/assessing-new-domain-environment/images/FH3_hu419774db8288159a914514494e686304_2635976_640x0_resize_q75_bgffffff_box_3.jpg" width="1919" height="1080" alt="can you blame me for not answering the phone? " title="can you blame me for not answering the phone? " loading="lazy" />
  </picture><p class="text-sm text-center text-slate-500 dark:text-slate-300">Image of Forza Horizon game</p>
</div>
</p>
<p>He told me that he needs to get some basic information about those topics:</p>
<ul>
<li>Forest information</li>
<li>Domain information</li>
<li>GPO information</li>
<li>DHCP authorized server information</li>
<li>Users information</li>
<li>Group information</li>
</ul>
<p>I asked him to prepare a computer in the domain with Remote Server Administration Tools (RSAT) and get a user credentials in the domain (no special privilege) while Iâ€™m writing him a guide.</p>
<h2 id="forest-information">Forest Information</h2>
<p>When we install the RSAT, we get lot of new Powershell cmdlet.
One of them is Get-ADForest cmdlet. Using this command, we can get information about the active directory forest (surprised?)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$ForestInformation = Get-ADForest
</span></span></code></pre></div><p>Each cmdlet can give us lot of information, and we donâ€™t want to get lost, so in each cmdlet, we will focus on the information I think most relevant, I encourage you to investigate every cmdlet you see here if you donâ€™t familiar with.</p>
<p>We would like to get information about the forest functional level, the domains in the forest, the root domain and schema master dc:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$ForestInformation | Select-Object ForestMode,Domains,RootDomain,SchemaMaster | Format-List
</span></span><span style="display:flex;"><span>ForestMode   <span style="color:#960050;background-color:#1e0010">:</span> Windows2008R2Forest
</span></span><span style="display:flex;"><span>Domains      <span style="color:#960050;background-color:#1e0010">:</span> {saggiehaim.net}
</span></span><span style="display:flex;"><span>RootDomain   <span style="color:#960050;background-color:#1e0010">:</span> saggiehaim.net
</span></span><span style="display:flex;"><span>SchemaMaster <span style="color:#960050;background-color:#1e0010">:</span> SHDC01.saggiehaim.net
</span></span></code></pre></div><blockquote>
<p>The reason we put it into a variable first is because we will use it later.</p>
</blockquote>
<h2 id="domain-information">Domain Information</h2>
<p>In this part we will use two cmdlets, Get-ADDomain and Get-ADDomainController.
We will use those cmdlets to find the functional level of the domains, the PDC and RID master, and information about the domain controllers.</p>
<p>First, we will use the Get-ADDomain, we will use it to get the following information: Name,Child Domains,Domain functional level,Infrastructure Master, PDC Emulator, RID Master.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e"># Single Domain Forest</span>
</span></span><span style="display:flex;"><span>Get-ADDomain | Select-Object Name,DomainMode,InfrastructureMaster,PDCEmulator,RIDMaster | Format-List
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Multi Domain Forest</span>
</span></span><span style="display:flex;"><span>($ForestInformation).Domains | Get-ADDomain | Select-Object Name,ChildDomains,DomainMode,InfrastructureMaster,PDCEmulator,RIDMaster | Format-List
</span></span></code></pre></div><p>Now we will use the Get-ADDomainController to get information about the Domain Controllers in each domain, it will be useful to get information about: Hostname, IPv4Address, Operating System, the LDAP and SSL Ports, and which site it belongs to:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e"># Single Domain Forest</span>
</span></span><span style="display:flex;"><span>Get-ADDomainController -Filter * -Server saggiehaim.net  | Select-Object Hostname,IPv4Address,OperatingSystem,LDAPport,sslport,site | Format-List
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Multi Domain Forest</span>
</span></span><span style="display:flex;"><span>($ForestInformation).Domains | Get-ADDomainController -Filter * -Server $_  | Select-Object Domain,Hostname,IPv4Address,OperatingSystem,LDAPport,SSLport,site | Format-List
</span></span></code></pre></div><p>This will give us a nice list:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Hostname    <span style="color:#960050;background-color:#1e0010">:</span> SHDC01.saggiehaim.net
</span></span><span style="display:flex;"><span>IPv4Address <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">10.10</span>.0.1
</span></span><span style="display:flex;"><span>OperatingSystem <span style="color:#960050;background-color:#1e0010">:</span> Windows Server <span style="color:#ae81ff">2012</span> R2 Standard
</span></span><span style="display:flex;"><span>LDAPport    <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">389</span>
</span></span><span style="display:flex;"><span>sslport     <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">636</span>
</span></span><span style="display:flex;"><span>site        <span style="color:#960050;background-color:#1e0010">:</span> Lab
</span></span></code></pre></div><h2 id="gpo-information">GPO Information</h2>
<p>Now GPO is super important, and every Domain Services guy will tell you, it can make or break your environment.
When we start working on a new environment, we would like to know how many GPO we got and how many of them are not in use.</p>
<p>To get the GPOâ€™s quantity, we can just run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$GPOs = Get-GPO -All
</span></span><span style="display:flex;"><span>$GPOs.Count
</span></span></code></pre></div><p>To get the unlinked GPOâ€™s we can use the following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>import-module GroupPolicy
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$unlinkedGPOs = @()
</span></span><span style="display:flex;"><span>$GPOs = Get-GPO -All  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ForEach</span>($gpo  <span style="color:#66d9ef">in</span> $GPOs){ 
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">xml</span>]$GPOXMLReport = $gpo | Get-GPOReport -ReportType xml 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($GPOXMLReport.GPO.LinksTo <span style="color:#f92672">-eq</span> $null){ 
</span></span><span style="display:flex;"><span>        $unlinkedGPOs += $gpo 
</span></span><span style="display:flex;"><span>    }  
</span></span><span style="display:flex;"><span> }
</span></span></code></pre></div><p>When it&rsquo;s done, we can get the information from the $unlinkedGPOs variable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>DisplayName      <span style="color:#960050;background-color:#1e0010">:</span> Test GPO
</span></span><span style="display:flex;"><span>DomainName       <span style="color:#960050;background-color:#1e0010">:</span> saggiehaim.net
</span></span><span style="display:flex;"><span>Owner            <span style="color:#960050;background-color:#1e0010">:</span> saggiehaim\Domain Admins
</span></span><span style="display:flex;"><span>Id               <span style="color:#960050;background-color:#1e0010">:</span> eb9bf117-81c1-40f9-813a-ce211796189d
</span></span><span style="display:flex;"><span>GpoStatus        <span style="color:#960050;background-color:#1e0010">:</span> AllSettingsEnabled
</span></span><span style="display:flex;"><span>Description      <span style="color:#960050;background-color:#1e0010">:</span> 
</span></span><span style="display:flex;"><span>CreationTime     <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">9</span>/<span style="color:#ae81ff">23</span>/<span style="color:#ae81ff">2018</span> <span style="color:#ae81ff">12</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">38</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">02</span> PM
</span></span><span style="display:flex;"><span>ModificationTime <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">9</span>/<span style="color:#ae81ff">23</span>/<span style="color:#ae81ff">2018</span> <span style="color:#ae81ff">12</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">40</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">56</span> PM
</span></span><span style="display:flex;"><span>UserVersion      <span style="color:#960050;background-color:#1e0010">:</span> AD Version<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">3</span>, SysVol Version<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>ComputerVersion  <span style="color:#960050;background-color:#1e0010">:</span> AD Version<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>, SysVol Version<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>WmiFilter        <span style="color:#960050;background-color:#1e0010">:</span> 
</span></span></code></pre></div><h2 id="dhcp-authorized-server-information">DHCP Authorized Server Information</h2>
<p>DHCP can be a vulnerability, and it&rsquo;s something we want to control, we donâ€™t want rogue DHCP servers that will serve wrong IPâ€™s or worst, wonâ€™t be sync with the rest and will serve duplicated IPâ€™s.</p>
<p>To get the list of the authorized DHCP Servers we can use the cmdlet:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Get-DhcpServerInDC
</span></span></code></pre></div><h2 id="users-information">Users&rsquo; Information</h2>
<p>Itâ€™s all about the users, the most critical resource we have in our environment.
There are so many things we want to know about them, but we will limit it to the most important in my opinion:</p>
<ul>
<li>Number of users</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$users = Get-ADUser -Filter *
</span></span><span style="display:flex;"><span>$users.Count
</span></span></code></pre></div><ul>
<li>Count Number of active users</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>($users | where {$_.Enabled <span style="color:#f92672">-eq</span> $true}).count
</span></span></code></pre></div><ul>
<li>Get Number of locked out users</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>(Search-ADAccount -LockedOut).count
</span></span></code></pre></div><h2 id="group-information">Group Information</h2>
<p>Groups can often be a pain, and it easy to lose control over them, those cmdlets will help us get some control over them:</p>
<ul>
<li>Number of groups</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>(Get-ADGroup -Filter *).count
</span></span></code></pre></div><ul>
<li>Getting all empty groups</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Get-ADGroup -Properties Members -Filter * | Where-Object {$_.Members.Count <span style="color:#f92672">-eq</span> <span style="color:#ae81ff">0</span> } | Select-Object Name,DistinguishedName | Format-List
</span></span></code></pre></div><p>Today security is everywhere, and we all share the responsibility to keep our environment secure, we also like to get all the members of the Domain Admins and Enterprise Admins groups, we will ask questions about every member.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e"># Get Domain Admins members</span>
</span></span><span style="display:flex;"><span>(Get-ADGroup -Properties Members -Identity <span style="color:#e6db74">&#39;Domain Admins&#39;</span>).Members
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get Enterprise Admins members</span>
</span></span><span style="display:flex;"><span>(Get-ADGroup -Properties Members -Identity <span style="color:#e6db74">&#39;Enterprise Admins&#39;</span>).Members
</span></span></code></pre></div><p>Donâ€™t take it lightly.
I once saw a company with Domain Users in the Domain Admins group&hellip;</p>
<h2 id="conclusion">Conclusion</h2>
<p>One of the most challenging tasks in my job is taking over a domain environment.
It can be very complicated, and it can take so much time just to understand whatâ€™s going on.
There is a lot more information to look for, and lot more topics to investigate, but I think I gave you something to start with.</p>
<p>How will you counter this task? I would love to hear about it!</p>

      </article>

      




    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
    <a href="https://www.linkedin.com/in/saggie/" target="_blank" title="Linkedin" class="flex flex-row mr-2">
      <span class="hidden">Linkedin</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
    <a href="https://github.com/SaggehaimBlog" target="_blank" title="Github" class="flex flex-row mr-2">
      <span class="hidden">Github</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
 </i>
    </a>
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2018 - 2024 Saggie Haim
    
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.js"></script>





</body>
</html>
